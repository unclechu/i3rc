# i3 config file (v4)
#
# Please see http://i3wm.org/docs/userguide.html for a complete reference!

# TODO rotate focus (focus-next)
#      i3-msg -t get_tree
#      xdotool search --all --onlyvisible --desktop --class

# TODO rearrange numeric workspaces

# TODO zenity-based app to
#      1. fuzzy-select named workspace
#      2. fuzzy-select window by title
#      3. renaming workspaces
#      4. marking windows
#      5. navigating by marked windows

# TODO notify applet to receive notifications

# TODO realize how to prevent some apps from *real* fullscreen (like in xmonad)

# TODO fork compton to patch negative-colors feature to make window colors also
#      grayscale

# TODO `exec invert-window-colors` on matched windows when focusing on
#      them (because windows that are on currently hidden workspaces aren't
#      handled)

set $m Mod4
set $a Mod1
set $s Shift

set $d1 DisplayPort-0
set $d2 HDMI-2
set $d3 DVI-0

# starting from 4th workspace because first three bounded to specific outputs
set $new_workspace "i3-msg workspace -- $((`i3-msg -t get_workspaces | jq 'map(select(.num > 0).num) | [range(4; ([max+2, 5] | max))]-. | min'`))"
# set $new_workspace "i3-msg workspace -- $((`i3-msg -t get_workspaces | jq 'map(select(.num > 0).num) | [range(1; max+2)]-. | min'`))"

set $exterminate "kill -9 -- $((`xdotool getactivewindow getwindowpid`))"

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below.
# font pango:monospace 8
font pango:Hack 9

# This font is widely installed, provides lots of unicode glyphs, right-to-left
# text rendering and scalability on retina/hidpi displays (thanks to pango).
#font pango:DejaVu Sans Mono 8

# Before i3 v4.8, we used to recommend this one as the default:
# font -misc-fixed-medium-r-normal--13-120-75-75-C-70-iso10646-1
# The font above is very space-efficient, that is, it looks good, sharp and
# clear in small sizes. However, its unicode glyph coverage is limited, the old
# X core fonts rendering does not support right-to-left and this being a bitmap
# font, it doesn’t scale on retina/hidpi displays.

# Use Mouse+$m to drag floating windows to their wanted position
floating_modifier $m

floating_minimum_size 5 x 5

# start a terminal
# bindsym $m+Return exec i3-sensible-terminal
bindsym $m+Return exec termite-dark.sh
bindsym $m+$a+Return exec termite-light.sh

# kill focused window
bindsym $m+$a+q kill

# also: i3-dmenu-desktop
bindsym $m+semicolon exec gmrun
bindsym $m+$a+semicolon exec dmenu_run

bindsym $m+apostrophe exec gpaste-zenity.sh
bindsym $m+$a+apostrophe exec gpaste-zenity.sh -m=choose

bindsym $m+n exec timeout 2s invert-window-colors
bindsym $m+m exec place-cursor-at

bindsym $m+u focus output $d1
bindsym $m+i focus output $d2
bindsym $m+o focus output $d3

bindsym $m+$a+u move container to output $d1
bindsym $m+$a+i move container to output $d2
bindsym $m+$a+o move container to output $d3

bindsym Print exec gnome-screenshot
bindsym $m+Print exec gnome-screenshot -w
bindsym --release Pause exec gnome-screenshot -a
bindsym $m+Pause exec gnome-screenshot -ia

bindsym $m+XF86AudioPlay exec audacious --play
bindsym XF86AudioPlay exec audacious --play-pause
bindsym XF86AudioPrev exec audacious --rew
bindsym XF86AudioNext exec audacious --fwd
bindsym XF86AudioStop exec audacious --stop

bindsym XF86Calculator exec gnome-calculator

bindsym $m+XF86AudioMute exec pamng.sh reset
bindsym XF86AudioMute exec pamng.sh mute
bindsym XF86AudioLowerVolume exec pamng.sh dec
bindsym XF86AudioRaiseVolume exec pamng.sh inc

# change focus
bindsym $m+h focus left
bindsym $m+j focus down
bindsym $m+k focus up
bindsym $m+l focus right

# alternatively, you can use the cursor keys:
bindsym $m+Left focus left
bindsym $m+Down focus down
bindsym $m+Up focus up
bindsym $m+Right focus right

# move focused window
bindsym $m+$a+h move left
bindsym $m+$a+j move down
bindsym $m+$a+k move up
bindsym $m+$a+l move right

# alternatively, you can use the cursor keys:
bindsym $m+$a+Left move left
bindsym $m+$a+Down move down
bindsym $m+$a+Up move up
bindsym $m+$a+Right move right

bindsym $m+c split v
bindsym $m+v split h

# enter fullscreen mode for the focused container
bindsym $m+f fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $m+s layout stacking
bindsym $m+w layout tabbed
bindsym $m+e layout toggle split

# toggle tiling / floating
bindsym $m+$a+space floating toggle

# change focus between tiling / floating windows
bindsym $m+space focus mode_toggle

# focus the parent container
bindsym $m+a focus parent
# focus the child container
bindsym $m+$a+a focus child

# switch to workspace
bindsym $m+1 workspace 1
bindsym $m+2 workspace 2
bindsym $m+3 workspace 3
bindsym $m+4 workspace 4
bindsym $m+5 workspace 5
bindsym $m+6 workspace 6
bindsym $m+7 workspace 7
bindsym $m+8 workspace 8
bindsym $m+9 workspace 9
bindsym $m+0 workspace 10

# move focused container to workspace
bindsym $m+$a+1 move container to workspace 1
bindsym $m+$a+2 move container to workspace 2
bindsym $m+$a+3 move container to workspace 3
bindsym $m+$a+4 move container to workspace 4
bindsym $m+$a+5 move container to workspace 5
bindsym $m+$a+6 move container to workspace 6
bindsym $m+$a+7 move container to workspace 7
bindsym $m+$a+8 move container to workspace 8
bindsym $m+$a+9 move container to workspace 9
bindsym $m+$a+0 move container to workspace 10

bindsym $m+z workspace prev_on_output
bindsym $m+x workspace next_on_output
bindsym $m+$a+z move container to workspace prev_on_output
bindsym $m+$a+x move container to workspace next_on_output
bindsym $m+b exec $new_workspace

bindsym $m+comma move workspace to left
bindsym $m+period move workspace to right

# reload the configuration file
bindsym $m+$a+c reload
# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $m+$a+r restart
# exit i3 (logs you out of your X session)
bindsym $m+$a+e exec "i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'"

# resize window (you can also use the mouse for that)
mode "resize" {
  bindsym Return mode "default"
  bindsym Escape mode "default"

  bindsym h resize shrink width 1 px or 1 ppt
  bindsym j resize grow height 1 px or 1 ppt
  bindsym k resize shrink height 1 px or 1 ppt
  bindsym l resize grow width 1 px or 1 ppt

  bindsym $a+h resize shrink width 5 px or 5 ppt
  bindsym $a+j resize grow height 5 px or 5 ppt
  bindsym $a+k resize shrink height 5 px or 5 ppt
  bindsym $a+l resize grow width 5 px or 5 ppt

  bindsym $s+h resize shrink width 10 px or 10 ppt
  bindsym $s+j resize grow height 10 px or 10 ppt
  bindsym $s+k resize shrink height 10 px or 10 ppt
  bindsym $s+l resize grow width 10 px or 10 ppt

  bindsym Left resize shrink width 10 px or 10 ppt
  bindsym Down resize grow height 10 px or 10 ppt
  bindsym Up resize shrink height 10 px or 10 ppt
  bindsym Right resize grow width 10 px or 10 ppt
}

mode "do" {
  bindsym Return mode "default"
  bindsym Escape mode "default"

  bindsym $m+r exec autostart.sh; mode "default"
  bindsym $m+q exec $exterminate; mode "default"
  bindsym $m+i exec input.sh;     mode "default"

  bindsym x exec cursor-to-display.sh 1
  bindsym c exec cursor-to-display.sh 2
  bindsym v exec cursor-to-display.sh 3
  bindsym z exec place-cursor-at; mode "default"

  bindsym a sticky toggle; mode "default"
  bindsym b border toggle

  bindsym s exec shutter; mode "default"
  bindsym e [class="^Termite" title="vim"] focus; mode "default"

  # jump to audacious windows (when it's float, winamp classic interface)
  bindsym m [class="^Audacious$" title="Audacious$" floating] focus; mode "default"
  bindsym p [class="^Audacious$" title="^Audacious Playlist Editor$" floating] focus; mode "default"

  bindsym n exec timeout 2s invert-window-colors app all; mode "default"

  bindsym semicolon exec gmrun; mode "default"
  bindsym $a+semicolon exec dmenu_run; mode "default"
}

mode "workspace" {
  bindsym Return mode "default"
  bindsym Escape mode "default"

  bindsym $a+u move workspace to output $d1
  bindsym $a+i move workspace to output $d2
  bindsym $a+o move workspace to output $d3

  bindsym    i                   workspace im; mode "default"
  bindsym $s+i move container to workspace im; mode "default"

  bindsym    m                   workspace music; mode "default"
  bindsym $s+m move container to workspace music; mode "default"

  bindsym    v                   workspace video; mode "default"
  bindsym $s+v move container to workspace video; mode "default"

  bindsym    g                   workspace main; mode "default"
  bindsym $s+g move container to workspace main; mode "default"

  bindsym    c                   workspace code; mode "default"
  bindsym $s+c move container to workspace code; mode "default"

  bindsym    1                   workspace 1; mode "default"
  bindsym $s+1 move container to workspace 1; mode "default"
  bindsym    2                   workspace 2; mode "default"
  bindsym $s+2 move container to workspace 2; mode "default"
  bindsym    3                   workspace 3; mode "default"
  bindsym $s+3 move container to workspace 3; mode "default"
  bindsym    4                   workspace 4; mode "default"
  bindsym $s+4 move container to workspace 4; mode "default"
  bindsym    5                   workspace 5; mode "default"
  bindsym $s+5 move container to workspace 5; mode "default"
  bindsym    6                   workspace 6; mode "default"
  bindsym $s+6 move container to workspace 6; mode "default"
  bindsym    7                   workspace 7; mode "default"
  bindsym $s+7 move container to workspace 7; mode "default"
  bindsym    8                   workspace 8; mode "default"
  bindsym $s+8 move container to workspace 8; mode "default"
  bindsym    9                   workspace 9; mode "default"
  bindsym $s+9 move container to workspace 9; mode "default"
  bindsym    0                   workspace 10; mode "default"
  bindsym $s+0 move container to workspace 10; mode "default"

  bindsym    z                   workspace prev_on_output
  bindsym $s+z move container to workspace prev_on_output
  bindsym    x                   workspace next_on_output
  bindsym $s+x move container to workspace next_on_output

  bindsym b workspace back_and_forth; mode "default"
  bindsym n exec $new_workspace; mode "default"
}

bindsym $m+d mode "do"
bindsym $m+g mode "workspace"
bindsym $m+r mode "resize"

bar {
  status_command unclechu-i3-status
}

workspace 2 output $d1
workspace 1 output $d2
workspace 3 output $d3

workspace music output $d1
assign [class="^Audacious$"] → music

workspace video output $d1
assign [class="^smplayer$"] → video
assign [class="^vlc$"] → video

workspace im output $d3
assign [class="^Gajim$"]       → im
assign [class="^Hexchat$"]     → im
assign [class="^utox$"]        → im
assign [class="^qTox$"]        → im
assign [class="^Gnome-ring$"]  → im
assign [class="^Riot$"]        → im
assign [class="^Rambox$"]      → im
assign [class="^Thunderbird$"] → im
assign [class="^nheko"]        → im

workspace main output $d2
workspace code output $d2

for_window [class="^qjackctl$"]                  floating enable
for_window [title="^Place Cursor At"]            border none
for_window [class="^Audacious$" floating]        border pixel 2
for_window [class="^Gnome-calculator$"]          border pixel 2
for_window [class="^(Gnome-calendar|Nautilus)$"] border normal
for_window [title="^Android Emulator"]           floating enable; border normal
for_window [class="^Eog$"]                       border normal
for_window [class="^Evince$"]                    border normal
for_window [class="^File-roller$"]               border normal
for_window [class="^Totem$"]                     border normal
for_window [class="^Gedit$"]                     border normal

focus_on_window_activation none

no_focus   [class=".*"]
for_window [class="^Gmrun$"]            focus
for_window [class="^Termite"]           focus
for_window [title="^Place Cursor At"]   focus
for_window [class="^Gnome-calculator$"] focus
for_window [class="^Zenity$"]           focus

# for_window [class="^Gajim$"]       exec timeout 2s invert-window-colors app gajim
# for_window [class="^Thunderbird$"] exec timeout 2s invert-window-colors app thunderbird
# for_window [class="^Audacious$"]   exec timeout 2s invert-window-colors app audacious
# for_window [class="^nheko$"]       exec timeout 2s invert-window-colors app nheko
# for_window [class="^Keepassx$"]    exec timeout 2s invert-window-colors app keepassx
# for_window [class="^qBittorrent$"] exec timeout 2s invert-window-colors app qbittorrent
# for_window [class="^Hexchat$"]     exec timeout 2s invert-window-colors app hexchat
# for_window [class="^Doublecmd$"]   exec timeout 2s invert-window-colors app doublecmd
# for_window [class="^Gmrun$"]       exec timeout 2s invert-window-colors app gmrun

exec_always timeout 2s invert-window-colors app all
